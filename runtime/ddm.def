Bootstrap: docker
From: ubuntu:20.04

%files
    ./requirements.txt .

%labels
    python3 + DiffDisMatter

%post -c /bin/bash
    export DEBIAN_FRONTEND=noninteractive
    echo "tzdata tzdata/Areas select Etc" | debconf-set-selections
    echo "tzdata tzdata/Zones/Etc select UTC" | debconf-set-selections

    apt-get clean
    apt-get update
    apt update
    apt install -y wget python3 python3-venv python3-pip git

    python3 -m venv ./venv --system-site-packages
    source ./venv/bin/activate

    pip install torch==2.4.1 torchvision torchaudio
    pip install torch_geometric
    pip install pyg_lib torch_scatter torch_sparse torch_cluster torch_spline_conv -f https://data.pyg.org/whl/torch-2.4.1+cu121.html

    git clone https://github.com/ACEsuit/mace-layer.git
    pip install ./mace-layer
    pip install -r requirements.txt


%environment
    export PATH=/venv/bin:$PATH

%runscript
    /venv/bin/python3
